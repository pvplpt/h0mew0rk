## Урок 12. HTTP запросы по сети

### Цели практической работы

Получить понимание и навык работы с HTTP-запросами. Научиться:  
• подключать библиотеку CPR к CMake-проекту;  
• осуществлять запросы разных типов;  
• выводить и анализировать данные, полученные от запросов;  
• передавать дополнительные аргументы в запросах.

### Что входит в работу

1. Реализовать пользовательские запросы.
2. Реализовать захват заголовка HTML-страницы.
3. Реализовать запросы разных типов с аргументами.

### Общие условия

Разработка выполняется в среде VS Code. Текстовые документы можно редактировать в стандартном блокноте.

### Задание 1. Пользовательские запросы

#### Что нужно сделать

Реализуйте программу по осуществлению различных типов HTTP-запросов к сервису httpbin.org.  
Пользователь взаимодействует с программой с помощью команд: “get”, “post”, “put”, “delete”, “patch”. В зависимости от команды к серверу httpbin.org осуществляется запрос того или иного типа. Содержимое ответа сервера выводится в стандартный вывод.
Программа завершается, когда пользователь вводит команду “exit”.

#### Рекомендации

Для каждого HTTP-запроса в CPR есть отдельный метод, например cpr::Get.

#### Что оценивается

Корректность выполнения запросов к сервису в зависимости от пользовательских команд.

#### Как отправить задание на проверку

Пришлите ссылку на repl.it или файл .срр с решением через форму ниже.

### Задание 2. Захват заголовка веб-страницы

#### Что нужно сделать

Запросите с сервера HTML-страницу. Для этого изучите документацию о запросах, поддерживаемых сервисом httpbin.org/html. Найдите там запрос, который выдаёт именно HTML-страницу. Затем сделайте запрос, явным образом используя заголовок accept: text/html. В полученном ответе найдите заголовок статьи и выведите его в консоль.

#### Рекомендации

Заголовок статьи размещается между HTML-тегами \<h1>\</h1>.  
Для доступа к тексту ответа вам потребуется метод text класса cpr::Response. Для поиска по тексту нужных HTML-тегов лучше использовать метод find.

#### Что оценивается

Корректность работы программы и полученного результата.

#### Как отправить задание на проверку

Пришлите ссылку на repl.it или файл .срр с решением через форму ниже.

### Задание 3. Запросы с аргументами

#### Что нужно сделать

Сделайте запрос к сервису httpbin.org, отправив при этом несколько дополнительных аргументов с данными.  
Все названия аргументов и их значения строковые и принимаются от пользователя. Пользователь последовательно вводит их названия вместе со значениями, пока не встретится аргумент с названием “post” или “get”, что будет означать, что ввод аргументов закончен и требуется отправить их на сервер выбранным способом.
Если пользователь выбрал “post”, то выполняется POST-запрос и аргументы отправляются POST-способом (как форма). Если “get”, то выполняется GET-запрос с GET-аргументами (прямо в URL).  
По результатам выполнения запроса выведите ответ сервера в стандартную консоль и обратите внимание на поля form или args, в зависимости от типа запроса в которых должны быть перечислены все введённые вами аргументы.

#### Рекомендации

Чтобы создать экземпляр объекта cpr::Payload для POST-запроса, используйте конструктор, который принимает диапазон итераторов массива от begin() до end(), соответственно. При этом тип элементов массива должен быть cpr:Pair, а сам массив содержит в себе имена параметров вместе с их значениями. Каждый элемент можно инициализировать с помощью конструктора cpr::Pair((std::string)key, (std::string)value). Обратите внимание на использование эксплицитного приведения к строкам. Это может понадобиться, если используется старая версия библиотеки cpr.
Согласно HTTP-стандарту, аргументы в GET-запросах перечисляются прямо в URL запроса после вопросительного знака. Названия аргументов отделяются от их значений с помощью символа “=”, а сами аргументы разделены символами “&”. Пример аргументов, заданных в URL запроса:  
?foo=first&animal=cat&bar=third  
Для хранения названий параметров и их значений используйте словарь:  
std::map<std::string, std::string> arguments;  
В таких словарях могут содержаться данные вида {“height”, “185”}, {“weight”, “75”}. В случае с нашими запросами там будет что-то другое, но идея та же: название — значение. Чтобы пройти по такому словарю, потребуется итератор вида std::map<std::string, std::string>::iterator it; Используйте его так:

```
for (it = arguments.begin(); it != arguments.end(); it++)
{
it->first // даёт доступ к названию параметра
it->second // даёт доступ к значению параметра
}
```

#### Что оценивается

Корректность работы программы при различных пользовательских данных.

#### Как отправить задание на проверку

Пришлите ссылку на repl.it или файл .срр с решением через форму для сдачи домашнего задания.
